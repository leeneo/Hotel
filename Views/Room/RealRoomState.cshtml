@{
    Layout = null;
}
@model QueryModel.RealTimeState
<!DOCTYPE html>
<html lang="zh-cn">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1">
    <meta name="description" content="">
    <meta name="keywords" content="">
    <meta name="author" content="">
    <title>实时房态</title>
    <link rel="stylesheet" href="../../wwwroot/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="../../wwwroot/neoui/css/neoui.css">
    <link rel="stylesheet" href="../../wwwroot/neoui/css/navbar.css">
    <link rel="stylesheet" href="../../wwwroot/neoui/css/utils.css">
    <style>
        body {
            padding-bottom: 50px;
        }

        .nav-tabs li {
            width: 33.33%
        }

            .nav-tabs li a {
                border-radius: 0;
                border-top: 0;
            }

        .nav-tabs > li.active > a,
        .nav-tabs > li.active > a:focus,
        .nav-tabs > li.active > a:hover {
            border-top: 0;
        }

        .nav-tabs > li:first-child.active > a,
        .nav-tabs > li:first-child.active > a:focus,
        .nav-tabs > li:first-child.active > a:hover {
            border-left: 0;
        }

        .nav-tabs > li:last-child.active > a,
        .nav-tabs > li:last-child.active > a:focus,
        .nav-tabs > li:last-child.active > a:hover {
            border-right: 0;
        }

        .list-group-item {
            border: 0;
        }

        .panel-body {
            text-align: center;
        }

        .label {
            margin-bottom: 6px;
            padding: 8px 12px;
            display: inline-block
        }

        .list-group {
            padding: 1.5rem .5rem;
            overflow: hidden;
            text-align: left;
            border: 1px solid #d6e9c6;
            margin-bottom: 0;
        }

        .list-group-item {
            float: left;
            margin: 2px;
            padding: .667rem;
            width: 32%;
            box-shadow: 0px 0px 2px 0px rgba(34, 34, 34, 0.5);
        }

    </style>
</head>

<body>
    <div class="">
        <!-- Nav tabs -->
        <!--@*<ul class="nav nav-tabs" role="tablist" id="myTabs">
            <li role="presentation" class="active">
                <a href="#home" aria-controls="home" role="tab" data-toggle="tab">房号</a>
            </li>
            <li role="presentation">
                <a href="#profile" aria-controls="profile" role="tab" data-toggle="tab">房型</a>
            </li>
            <li role="presentation">
                <a href="#messages" aria-controls="messages" role="tab" data-toggle="tab">占住率</a>
            </li>
        </ul>*@ -->
        <!--@*<!-- Tab panes -->
        <div class="tab-content">
            <!-- 房号选项卡 -->
            <div role="tabpanel" class="tab-pane active" id="home">
                <!-- 房间类型 -->

                <ul class="list-group">
                    <li class="list-group-item list-group-item-warning" id="hsTotal" data-hstotal="@Model.TotalRooms[0].TotalRooms">
                        <span class="badge">@Model.TotalRooms[0].TotalRooms</span>全部房间
                    </li>
                    <li class="list-group-item list-group-item-info">
                        <span class="badge">@Model.TotalRooms[0].EmptyClean</span>空静房
                    </li>
                    <li class="list-group-item list-group-item-success" id="lvClean" data-lvclean="@Model.TotalRooms[0].LivingClean">
                        <span class="badge">@Model.TotalRooms[0].LivingClean</span>住客静房
                    </li>
                    <li class="list-group-item list-group-item-danger" id="lvDirty" data-lvdirty="@Model.TotalRooms[0].LivingDirty">
                        <span class="badge">@Model.TotalRooms[0].LivingDirty</span>住客脏房
                    </li>
                    <li class="list-group-item bgColor-gray">
                        <span class="badge">@Model.TotalRooms[0].EmptyDirty</span>空脏房
                    </li>
                    <li class="list-group-item bgColor-blue">
                        <span class="badge">@Model.TotalRooms[0].ReserveClean</span>预约净房
                    </li>
                    <li class="list-group-item bgColor-green-blue">
                        <span class="badge">@Model.TotalRooms[0].ReserveDirty</span>预约脏房
                    </li>
                    <li class="list-group-item bgColor-lightblack" id="rmRepair" data-repair="@Model.TotalRooms[0].RepairRooms">
                        <span class="badge">@Model.TotalRooms[0].RepairRooms</span>维修房
                    </li>
                    <li class="list-group-item bgColor-lightblack" id="rmSelf" data-self="@Model.TotalRooms[0].SelfRooms" style="display:none">
                        <span class="badge">@Model.TotalRooms[0].SelfRooms</span>自用房
                    </li>
                </ul>

                <!-- 入住率 -->
                <div class="panel panel-default">
                    <div class="panel-heading">
                        当前入住率：
                        <span id="livingPercent"></span>
                    </div>
                    <div class="panel-body">
                        总房价：
                        <span>@Model.TotalRooms[0].TotalAmt</span> 元
                    </div>
                </div>
                <!-- 房间号 -->
                @foreach(var floor in Model.Floors) {
                    <div class="panel panel-success">
                        <div class="panel-heading">
                            <h3 class="panel-title">
                                <i>@floor.FloorNo</i> 楼
                                <b>@floor.RoomCount</b> 间
                            </h3>
                        </div>

                            <div class="panel-body">
                                @foreach (var house in Model.RoomStates.Where(x=>x.s_floor.ToString()==floor.FloorNo))
                                {
                                    <span class="label label-danger" style="background-color:rgb(@house.color)">@house.s_room_no</span>
                                }
                            </div>

                    </div>
                }
            </div>
            <div role="tabpanel" class="tab-pane" id="profile"></div>
            <div role="tabpanel" class="tab-pane" id="messages"></div>
        </div>*@-->
        <div role="tabpanel" class="tab-pane active" id="home">
            <div class="panTit">实时房态</div>
            <!-- 房间类型 -->
            <ul class="list-group">
                <li class="list-group-item list-group-item-warning" id="hsTotal" data-hstotal="@Model.TotalRooms[0].TotalRooms">
                    <span class="badge">@Model.TotalRooms[0].TotalRooms</span>全部房间
                </li>
                <li class="list-group-item list-group-item-info">
                    <span class="badge">@Model.TotalRooms[0].EmptyClean</span>空静房
                </li>
                <li class="list-group-item list-group-item-success" id="lvClean" data-lvclean="@Model.TotalRooms[0].LivingClean">
                    <span class="badge">@Model.TotalRooms[0].LivingClean</span>住客静房
                </li>
                <li class="list-group-item list-group-item-danger" id="lvDirty" data-lvdirty="@Model.TotalRooms[0].LivingDirty">
                    <span class="badge">@Model.TotalRooms[0].LivingDirty</span>住客脏房
                </li>
                <li class="list-group-item bgColor-gray">
                    <span class="badge">@Model.TotalRooms[0].EmptyDirty</span>空脏房
                </li>
                <li class="list-group-item bgColor-blue">
                    <span class="badge">@Model.TotalRooms[0].ReserveClean</span>预约净房
                </li>
                <li class="list-group-item bgColor-green-blue">
                    <span class="badge">@Model.TotalRooms[0].ReserveDirty</span>预约脏房
                </li>
                <li class="list-group-item bgColor-lightblack" id="rmRepair" data-repair="@Model.TotalRooms[0].RepairRooms">
                    <span class="badge">@Model.TotalRooms[0].RepairRooms</span>维修房
                </li>
                <li class="list-group-item bgColor-lightblack" id="rmSelf" data-self="@Model.TotalRooms[0].SelfRooms" style="display:none">
                    <span class="badge">@Model.TotalRooms[0].SelfRooms</span>自用房
                </li>
                <li class="list-group-item bgColor-lightblack" id="rmLock" data-locked="@Model.TotalRooms[0].LockRooms" style="display:none">
                    <span class="badge">@Model.TotalRooms[0].LockRooms</span>锁房
                </li>
            </ul>

            <!-- 入住率 -->
            <div class="panel panel-default">
                <div class="panel-heading" style="overflow:hidden">                   
                    <span id="livingPercent" style="float:right">当前入住率：<b></b></span>
                    <span style="float:left" id="averageHSP">平均房价：<b></b> 元</span>
                </div>
                <div class="panel-body">
                    <span id="totalHSP">总房价：<b>@Model.TotalRooms[0].TotalAmt</b> 元</span>
                </div>
            </div>
            <!-- 房间号 -->
            @foreach (var floor in Model.Floors)
            {
                <div class="panel panel-success">
                    <div class="panel-heading">
                        <h3 class="panel-title">
                            <i>@floor.FloorNo</i> 楼
                            <b>@floor.RoomCount</b> 间
                        </h3>
                    </div>

                    <div class="panel-body">
                        @foreach (var house in Model.RoomStates.Where(x => x.s_floor.ToString() == floor.FloorNo))
                        {
                            <span class="label label-danger" style="background-color:rgb(@house.color)">@house.s_room_no</span>
                        }
                    </div>

                </div>
            }
        </div>


    </div>

    @RenderPage("../Shared/_Footer.cshtml.cshtml")

    <script src="http://cdn.static.runoob.com/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="../../wwwroot/bootstrap/js/bootstrap.min.js"></script>
    <script>
        $(function () {

            //设置当前页导航链接颜色为linkblue
            function setLinkBlue() {
                var $links = $('nav a');
                var title = $('title').text().trim();
                $links.removeClass('linkBlue');
                $links.each(function () {
                    if ($(this).text().trim() === title)
                        $(this).addClass('linkBlue');
                });
            }
            setLinkBlue();

            var lvClean = $('#lvClean').data('lvclean');
            var lvDirty = $('#lvDirty').data('lvdirty');
            var hsTotal = $('#hsTotal').data('hstotal');
            var repair = $('#rmRepair').data('repair');
            var self = $('#rmSelf').data('self');
            var locked = $('#rmLock').data('locked');
            var useableHouse = hsTotal - repair - self - locked;
            var $livingPercent = $('#livingPercent b');

            //入住率
            livingPercent = (lvClean + lvDirty) / useableHouse * 100;
            $livingPercent.text(livingPercent.toFixed(2) + '%');
            console.log(self);
            localStorage.useableHouse = useableHouse;//存储可用房间数

            //平均房价
            var $averageHSP = $('#averageHSP b');
            var totalHSP = $('#totalHSP b').text();
            //$averageHSP.text((totalHSP / useableHouse).toFixed(2));
            $averageHSP.text((totalHSP / (lvClean + lvDirty)).toFixed(2));
        })
    </script>
</body>

</html>