@{
    Layout = null;
}
@model List<QueryModel.DailyReport>

<!DOCTYPE html>
<html lang="zh-cn">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1">
    <meta name="description" content="">
    <meta name="keywords" content="">
    <meta name="author" content="">
    <title>营业日报</title>
    <link rel="stylesheet" href="~/wwwroot/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="~/wwwroot/neoui/css/neoui.css">
    <link rel="stylesheet" href="~/wwwroot/neoui/css/navbar.css">
    <link rel="stylesheet" href="~/wwwroot/neoui/css/utils.css">
    <style>
        body {
            padding-bottom: 50px;
        }

        .tab-content {
            margin-top: -9px;
        }

        .nav-tabs {
            margin-top: 10px;
            border: 1px solid #ddd;
            border-bottom: 0;
        }

            .nav-tabs li {
                width: 50%
            }

                .nav-tabs li a {
                    border-radius: 0;
                    border-top: 0;
                }

            .nav-tabs > li.active > a,
            .nav-tabs > li.active > a:focus,
            .nav-tabs > li.active > a:hover {
                border-top: 0;
            }

            .nav-tabs > li:first-child.active > a,
            .nav-tabs > li:first-child.active > a:focus,
            .nav-tabs > li:first-child.active > a:hover {
                border-left: 0;
            }

            .nav-tabs > li:last-child.active > a,
            .nav-tabs > li:last-child.active > a:focus,
            .nav-tabs > li:last-child.active > a:hover {
                border-right: 0;
            }

        .list-group-item {
            border: 0;
        }

        .panel-body {
            text-align: center;
        }

        .label {
            margin-bottom: 6px;
            padding: 8px 12px;
            display: inline-block
        }

        .table {
            margin-top: 1rem
        }

        .tab-pane {
            margin-top: 1rem;
        }

        .table {
            border: 1px solid #c3c3c3;
        }

            .table thead {
                background-color: #358fd130;
            }

                .table thead th {
                    text-align: center;
                }

            .table td,
            .table th {
                border: 1px solid #c5c5c5;
                padding: 2px !important;
                text-align: left;
            }

        .container {
            overflow: hidden;
            padding: 4px;
            margin-top: 16px;
        }

        .input-group {
            width: 100%;
        }

        #myTabs li a {
            color: #555;
        }

        #myTabs li.active a {
            color: #337ab7;
        }
    </style>
</head>

<body>
    <div class="panTit">营业日报</div>
    <div class="container">

        <!-- 下拉菜单 -->
        <div class="input-group">
            <input type="date" id="dateInp" class="form-control">
            <!--@*<div class="input-group-btn">
                    <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <span class="caret"></span>
                    </button>
                </div>*@-->
        </div>

        <!--<!-- Tab panes -->
        <ul class="nav nav-tabs" role="tablist" id="myTabs">
            <li role="presentation" class="active" id="payM">
                <a href="#home" aria-controls="home" role="tab" data-toggle="tab">付款</a>
            </li>
            <li role="presentation" id="payF">
                <a href="#profile" aria-controls="profile" role="tab" data-toggle="tab">消费</a>
            </li>
        </ul>
        <div class="tab-content">
            <div role="tabpanel" class="tab-pane active" id="home">
                <!-- 在住信息列表 -->
                <table class="table">
                    <thead>
                        <tr>
                            <th>项目</th>
                            <th>当天</th>
                            <th>本月</th>
                            <th>本年</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var dayRP in Model.Where(x => x.s_dc == "C"))
                        {
                            <tr>
                                <td>@dayRP.vc_describe</td>
                                <td class="dayT">@dayRP.tday</td>
                                <td class="dayM">@dayRP.tmon</td>
                                <td class="dayY">@dayRP.tyear</td>
                            </tr>
                        }
                        <tr>
                            <td>合计</td>
                            <td class="sumT"></td>
                            <td class="sumM"></td>
                            <td class="sumY"></td>
                        </tr>
                        <tr>
                            <td>总额</td>
                            <td class="totalAM"></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div role="tabpanel" class="tab-pane" id="profile">
                <!-- 在住信息列表 -->
                <table class="table">
                    <thead>
                        <tr>
                            <th>项目</th>
                            <th>当天</th>
                            <th>本月</th>
                            <th>本年</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var dayRP in Model.Where(x => x.s_dc == "D"))
                        {
                            <tr>
                                <td>@dayRP.vc_describe</td>
                                <td class="dayT">@dayRP.tday</td>
                                <td class="dayM">@dayRP.tmon</td>
                                <td class="dayY">@dayRP.tyear</td>
                            </tr>
                        }
                        <tr>
                            <td>合计</td>
                            <td class="sumT"></td>
                            <td class="sumM"></td>
                            <td class="sumY"></td>
                        </tr>
                        <tr>
                            <td>总额</td>
                            <td class="totalAM"></td>
                        </tr>
                    </tbody>
                </table>

            </div>
        </div>
    </div>

    @RenderPage("../Shared/_Footer.cshtml.cshtml")

    <script src="http://cdn.static.runoob.com/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="~/wwwroot/bootstrap/js/bootstrap.min.js"></script>
    <script>
        $(function () {

            var $dateInp = $('#dateInp');
            var dateInp = $dateInp[0];
            dateInp.valueAsDate = new Date();
            var date = $dateInp.val();

            //var date = ($dateInp.valueAsDate = new Date()).toLocaleDateString();
            //$dateInp.prop('value', date);
            //console.log($dateInp.prop('value'));
            if (location.href == "http://" + location.host.trim() + "/Business/DailyReport") {
                var url = location.href + "?date=" + date;
                localStorage.date = date;
                location.href = url;
            }

            $dateInp.change(function () {
                localStorage.date = $dateInp.val();
                //location.href = "http://" + location.host.trim() + "/Business/DailyReport?date=" + $(this).val();
                window.location = "http://" + location.host.trim() + "/Business/DailyReport?date=" + $(this).val();
            });
            $dateInp.val(localStorage.date);
            console.log($dateInp.val());
            //alert(localStorage.date);
            //设置当前页导航链接颜色为linkblue
            function setLinkBlue() {
                var $links = $('nav a');
                var title = $('title').text().trim();
                $links.removeClass('linkBlue');
                $links.each(function () {
                    if ($(this).text().trim() === title)
                        $(this).addClass('linkBlue');
                });
            }
            setLinkBlue();

            //合计功能

            //付款消费分别合计
            var $payM = $('#payM'); //付款
            var $payF = $('#payF');//消费
            var sumT = sumM = sumY = 0;
            var $dayT = $('#home .dayT');
            var $dayM = $('#home .dayM');
            var $dayY = $('#home .dayY');
            var $sumT = $('#home .sumT');
            var $sumM = $('#home .sumM');
            var $sumY = $('#home .sumY');
            var $totSum = $('#home .totalAM');

            $payF.click(function () {
                sumT = sumM = sumY = 0;
                var $dayT = $('#profile .dayT');
                var $dayM = $('#profile .dayM');
                var $dayY = $('#profile .dayY');
                var $sumT = $('#profile .sumT');
                var $sumM = $('#profile .sumM');
                var $sumY = $('#profile .sumY');
                var $totSum = $('#profile .totalAM');

                $dayT.each(function () {
                    sumT += parseFloat($(this).text());
                })
                $sumT.text(sumT.toFixed(2));

                $dayM.each(function () {
                    sumM += parseFloat($(this).text());
                })
                $sumM.text(sumM.toFixed(2));

                $dayY.each(function () {
                    sumY += parseFloat($(this).text());
                })
                $sumY.text(sumY.toFixed(2));

                $totSum.text((sumT + sumM + sumY).toFixed(2));
            });

            $dayT.each(function () {
                sumT += parseFloat($(this).text());
            })
            $sumT.text(sumT.toFixed(2));

            $dayM.each(function () {
                sumM += parseFloat($(this).text());
            })
            $sumM.text(sumM.toFixed(2));

            $dayY.each(function () {
                sumY += parseFloat($(this).text());
            })
            $sumY.text(sumY.toFixed(2));

            $totSum.text((sumT + sumM + sumY).toFixed(2));

        })
    </script>
</body>

</html>